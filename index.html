<!DOCTYPE html>
<html>
<head>
  <title>Fake Sportsbook with Login</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .bet-line { margin-bottom: 20px; border: 1px solid #ccc; padding: 10px; }
    .bet-line h3 { margin: 0 0 10px 0; }
    .parlay, .history, .login { background: #f0f8ff; padding: 10px; margin-top: 20px; border: 1px solid #aaa; }
    button { margin: 3px; }
    #payoutPreview { font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Fake Sportsbook (Multi-user Parlay Edition)</h1>

  <!-- Login Options -->
  <div class="login">
    <button onclick="showLoginForm('member')">Member Login</button>
    <button onclick="showLoginForm('admin')">Admin Login</button>
  </div>

  <!-- Member Login Form -->
  <div id="memberLogin" style="display:none">
    <input type="text" id="usernameInput" placeholder="Enter your username">
    <button onclick="loginUser('member')">Log In</button>
  </div>

  <!-- Admin Login Form -->
  <div id="adminLogin" style="display:none">
    <input type="text" id="adminUsernameInput" placeholder="Enter admin username">
    <input type="password" id="adminPasswordInput" placeholder="Enter admin password">
    <button onclick="loginUser('admin')">Log In</button>
  </div>

  <div id="app" style="display:none">
    <p><strong>Balance:</strong> $<span id="balanceDisplay">0</span></p>

    <h2>Create New Bet (Admin Only)</h2>
    <input type="text" id="lineName" placeholder="e.g. Dylan over 20.5 points">
    <input type="text" id="optionA" placeholder="Option A">
    <input type="text" id="optionB" placeholder="Option B">
    <button onclick="createBetLine()">Create Bet</button>

    <h2>Active Betting Lines</h2>
    <div id="lines"></div>

    <div class="parlay">
      <h3>Parlay Cart</h3>
      <ul id="parlayList"></ul>
      <p id="payoutPreview">Potential Payout: N/A</p>
      <button onclick="placeParlay()">Place Parlay Bet</button>
    </div>

    <div class="history">
      <h3>Your Parlay History</h3>
      <div id="parlayHistoryList"></div>
    </div>
  </div>

  <!-- Display Current User -->
  <div id="currentUserDisplay" style="margin-top: 20px;"></div>

  <script>
    let users = {}; // { username: { balance: number, parlays: [] } }
    let currentUser = null;
    let isAdmin = false;

    let lines = [];
    let parlayCart = [];

    // Load betting lines from localStorage if they exist
    function loadLinesFromLocalStorage() {
        const savedLines = localStorage.getItem('lines');
        if (savedLines) {
            lines = JSON.parse(savedLines);
        } else {
            lines = []; // If no lines are saved, initialize an empty array
        }
    }

    // Save betting lines to localStorage
    function saveLinesToLocalStorage() {
        localStorage.setItem('lines', JSON.stringify(lines));
    }

    // Show the correct login form based on the type (admin or member)
    function showLoginForm(type) {
      console.log("Showing login form for type:", type);
      if (type === 'member') {
        document.getElementById("memberLogin").style.display = 'block';
        document.getElementById("adminLogin").style.display = 'none';
      } else if (type === 'admin') {
        document.getElementById("adminLogin").style.display = 'block';
        document.getElementById("memberLogin").style.display = 'none';
      }
    }

    // Login function for members and admins
    function loginUser(type) {
      console.log("Logging in as:", type);
      if (type === 'member') {
        const username = document.getElementById("usernameInput").value.trim();
        if (!username) return alert("Please enter a username");
        if (!users[username]) {
          users[username] = { balance: 1000, parlays: [] };
        }
        currentUser = username;
        isAdmin = false;
        console.log("Logged in as member:", username);
        document.getElementById("currentUserDisplay").innerText = `Logged in as: ${username}`;
        document.getElementById("app").style.display = 'block';
        loadLinesFromLocalStorage(); // Load lines from localStorage when member logs in
        renderLines();
        updateBalanceDisplay();
        renderParlayHistory();
        parlayCart = [];
        renderParlay();
      } else if (type === 'admin') {
        const adminUsername = document.getElementById("adminUsernameInput").value;
        const adminPassword = document.getElementById("adminPasswordInput").value;

        const adminUsernameValid = "admin"; // Set your admin username
        const adminPasswordValid = "admin123"; // Set your admin password

        if (adminUsername === adminUsernameValid && adminPassword === adminPasswordValid) {
          isAdmin = true;
          console.log("Logged in as admin:", adminUsername);
          document.getElementById("currentUserDisplay").innerText = `Logged in as Admin`;
          document.getElementById("app").style.display = 'block';
          loadLinesFromLocalStorage(); // Load lines from localStorage when admin logs in
          renderLines();
          updateBalanceDisplay();
          renderParlayHistory();
          parlayCart = [];
          renderParlay();
        } else {
          alert("Invalid admin credentials");
        }
      }
    }

    function updateBalanceDisplay() {
      document.getElementById("balanceDisplay").innerText = users[currentUser].balance;
    }

    function createBetLine() {
        if (!isAdmin) return alert("Only admins can create new bet lines.");
        const name = document.getElementById("lineName").value;
        const optionA = document.getElementById("optionA").value;
        const optionB = document.getElementById("optionB").value;
        if (!name || !optionA || !optionB) return alert("Fill all fields!");
        const line = {
            id: Date.now(),
            name,
            optionA,
            optionB,
            result: null
        };
        lines.push(line);
        saveLinesToLocalStorage(); // Save lines to localStorage after adding a new line
        renderLines();
    }

    // Add the other functions as needed (declareWinner, renderParlay, etc.)

  </script>
</body>
</html>
